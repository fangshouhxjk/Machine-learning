项目名称：基于pytorch深度学习框架的验证码识别模型设计

环境：python3.7、pytorch深度学习框架、cuda10

工具：pycharm2018

   项目利用facebook开源的pytorch框架，利用卷积神经网络构建神经网络训练模型，使用python中的captain函数生成验证码（模拟网页登陆需要的验证码，本项目是从0-9中的十个数字随机抽取四个组成一个验证码）然后将验证码加载到网络模型中进行训练，最后得到一个识别准确率在96%左右的神经网络模型。
   
代码模块解析：
1.CNNmodel.py
这个代码块是整个项目最核心的地方所在，构建的卷积神经网络模型就是在这个模块中进行构建的。一共构建了三层的卷积层然后又构建了两层全连接层。

2.CreateImage.py
这个模块的作用是调用captcat包，然后生成我们用来训练的验证码图片，在模块中可以设置生成验证码的数量，已经将生成的验证码图片保存位置。

3.test.py
该模块的作用是对训练好的验证码识别模型进行测试，通过不断的迭代测试文件夹中的文件，然后对总的图片数量进行统计，也对预测正确的图片进行统计，最后进行比较可以得出测试准确率，判定训练模型的优劣。cnn.load_state_dict(torch.load('./good/model.pkl'))加载的是整个训练过程中识别准确率最好模型。

4.Train.py
这个功能模块也是一个非常核心的模块，该模块功能是进行验证码图片的训练，将生成的验证码图片加载进来，然后再将cnn模型也加载进来，然后再将图片加载到模型中进行不断迭代训练，通过设置
num_epochs = 312 #训练迭代次数 
batch_size = 128 #训练批次大小
learning_rate = 0.001  #学习率

 if torch.cuda.is_available(): #判断是否支持GPU加速，使用GPU来加载计算图形，使用GPU进行加速训练可以在很大程度上提高模型的训练速度
        cnn = CNN().cuda()
        
  criterion = nn.MultiLabelSoftMarginLoss()#使用多标签分类损失函数，因为使用卷积神经网络进行图片训练可以不用像传统的方式一样再对图片进行分割然后一个一个的加载训练，而且传统的分割过程也是特别复杂的，这里使用到多标签分类损失函数可以直接对整个图片进行训练不用进行分割。
  
  optimizer = torch.optim.Adam(#优化函数使用 Adam 自适应优化算法，可以让模型在训练的过程中动态的进行学习参数调整，让模型沿着一个方向不断的发展。
        cnn.parameters(),
        lr=learning_rate)
 这个模块的内容很多，在代码中都有详细的解析。

5.captcha-seting.py
模块的作用是设置验证码中内容的来源，就像验证码图片中的数字是从这里设置的，取数从0-9，生成验证码的时候随机从这十个数里面取数，我们还可以设置生成更加复杂的验证码，将26个英文字母也可以写入，生成由数字和图片一起的复杂验证码，除了控制验证码的内容还要设置每一张验证码图片中验证码字符的个数，本项目是限制为四个字符，还要进行生成验证码图片的大小设置，本项目生成的验证码图片长度为160宽度为40的大小，然后再设置训练图片和测试图片的保存位置。

6.my_dataset.py
这个模块的作用主要是对进行模型训练的图片进行预处理，使得图片能够很好的进行训练，需要训练的图片很多验证码标签会很容易重复，为了减少重复率，在生成图片的时候，图片文件的命名格式 "4个数字_时间戳.PNG",同时对该值做 encode处理使得图片标签都是唯一的，使用Python split()方法通过指定分隔符对标签字符串进行切片,仅获取标签前面四个数值进行one.encode()处理。再对图片进行灰度化处理，使得图片训练的复杂度降低，更好的训练模型，灰度处理后将图片转为tensor矢量，进行归一化处理。最后一个就是对模型训练加载图片时加载的数量进行控制，batch_size大小是需要参考你的计算机内存大小来进行设置的，我设置的是32，因为我的计算机内存不是很大，这个参数的设置是指每一次加载进模型训练图片的数量，还有一个shuffle参数的设置，设置为true就是加载图片的时候是随机进行加载的，这样可以有效的避免因为加载的数据在某一个实践内差不多都是一样的，从而导致模型训练数据变化大，训练的模型泛化能力不足，模型稳定性比较差。

7.one_hot_ecoding.py
模块的作用是对验证码的标签进行处理，在加载图片训练的时候进行编码处理，使得计算机能够识别出文本标签，训练后进行解码，将计算机能够识别tensor向量转成文本标签。
独热编码处理，将文本标签转换为tensor向量
解码处理，将我们的tensor向量的标签转换为

本项目适合初步学习机器学习的朋友来看，因为项目识别的内容比较简单，很容易理解上手，加深自己对机器学习的深度学习的理解。
